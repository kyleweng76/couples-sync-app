window.openAddModal = function() {
  editingEventId = null;

  document.getElementById('input-title').value = '';
  document.getElementById('input-location').value = '';
  document.getElementById('input-note').value = '';
  document.getElementById('btn-delete').classList.add('hidden');

  window.setCategory('default');
  window.setNowToInputs();
  window.setStatus('confirmed');

  document.getElementById('check-allday').checked = true;
  window.toggleAllDay();

  document.getElementById('check-partner').checked = false;
  window.updateParticipantsPreview();

  // ⭐⭐ 關鍵兩行 ⭐⭐
  colorPickerTarget = 'event';
  currentSelectedColor = roleColors[currentUserRole];
  window.syncSelectedColorUI(); // ← 只在這裡同步 UI

  const m = document.getElementById('add-modal');
  m.classList.remove('hidden');
  setTimeout(()=>m.classList.add('visible'),10);
};
